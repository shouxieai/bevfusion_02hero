{
    "seed": 0,
    "deterministic": false,
    "checkpoint_config": {
        "interval": 1,
        "max_keep_ckpts": 1
    },
    "log_config": {
        "interval": 50,
        "hooks": [
            {
                "type": "TextLoggerHook"
            },
            {
                "type": "TensorboardLoggerHook"
            }
        ]
    },
    "load_from": null,
    "resume_from": null,
    "cudnn_benchmark": false,
    "fp16": {
        "loss_scale": {
            "growth_interval": 2000
        }
    },
    "max_epochs": 6,
    "runner": {
        "type": "CustomEpochBasedRunner",
        "max_epochs": 6
    },
    "dataset_type": "NuScenesDataset",
    "dataset_root": "data/nuscenes/",
    "gt_paste_stop_epoch": -1,
    "reduce_beams": 32,
    "load_dim": 5,
    "use_dim": 5,
    "load_augmented": null,
    "point_cloud_range": [
        -54.0,
        -54.0,
        -5.0,
        54.0,
        54.0,
        3.0
    ],
    "voxel_size": [
        0.075,
        0.075,
        0.2
    ],
    "image_size": [
        256,
        704
    ],
    "augment2d": {
        "resize": [
            [
                0.38,
                0.55
            ],
            [
                0.48,
                0.48
            ]
        ],
        "rotate": [
            -5.4,
            5.4
        ],
        "gridmask": {
            "prob": 0.0,
            "fixed_prob": true
        }
    },
    "augment3d": {
        "scale": [
            0.9,
            1.1
        ],
        "rotate": [
            -0.78539816,
            0.78539816
        ],
        "translate": 0.5
    },
    "object_classes": [
        "car",
        "truck",
        "construction_vehicle",
        "bus",
        "trailer",
        "barrier",
        "motorcycle",
        "bicycle",
        "pedestrian",
        "traffic_cone"
    ],
    "map_classes": [
        "drivable_area",
        "ped_crossing",
        "walkway",
        "stop_line",
        "carpark_area",
        "divider"
    ],
    "input_modality": {
        "use_lidar": true,
        "use_camera": true,
        "use_radar": false,
        "use_map": false,
        "use_external": false
    },
    "train_pipeline": [
        {
            "type": "LoadMultiViewImageFromFiles",
            "to_float32": true
        },
        {
            "type": "LoadPointsFromFile",
            "coord_type": "LIDAR",
            "load_dim": 5,
            "use_dim": 5,
            "reduce_beams": 32,
            "load_augmented": null
        },
        {
            "type": "LoadPointsFromMultiSweeps",
            "sweeps_num": 9,
            "load_dim": 5,
            "use_dim": 5,
            "reduce_beams": 32,
            "pad_empty_sweeps": true,
            "remove_close": true,
            "load_augmented": null
        },
        {
            "type": "LoadAnnotations3D",
            "with_bbox_3d": true,
            "with_label_3d": true,
            "with_attr_label": false
        },
        {
            "type": "ObjectPaste",
            "stop_epoch": -1,
            "db_sampler": {
                "dataset_root": "data/nuscenes/",
                "info_path": "data/nuscenes/nuscenes_dbinfos_train.pkl",
                "rate": 1.0,
                "prepare": {
                    "filter_by_difficulty": [
                        -1
                    ],
                    "filter_by_min_points": {
                        "car": 5,
                        "truck": 5,
                        "bus": 5,
                        "trailer": 5,
                        "construction_vehicle": 5,
                        "traffic_cone": 5,
                        "barrier": 5,
                        "motorcycle": 5,
                        "bicycle": 5,
                        "pedestrian": 5
                    }
                },
                "classes": [
                    "car",
                    "truck",
                    "construction_vehicle",
                    "bus",
                    "trailer",
                    "barrier",
                    "motorcycle",
                    "bicycle",
                    "pedestrian",
                    "traffic_cone"
                ],
                "sample_groups": {
                    "car": 2,
                    "truck": 3,
                    "construction_vehicle": 7,
                    "bus": 4,
                    "trailer": 6,
                    "barrier": 2,
                    "motorcycle": 6,
                    "bicycle": 6,
                    "pedestrian": 2,
                    "traffic_cone": 2
                },
                "points_loader": {
                    "type": "LoadPointsFromFile",
                    "coord_type": "LIDAR",
                    "load_dim": 5,
                    "use_dim": 5,
                    "reduce_beams": 32
                }
            }
        },
        {
            "type": "ImageAug3D",
            "final_dim": [
                256,
                704
            ],
            "resize_lim": [
                0.38,
                0.55
            ],
            "bot_pct_lim": [
                0.0,
                0.0
            ],
            "rot_lim": [
                -5.4,
                5.4
            ],
            "rand_flip": true,
            "is_train": true
        },
        {
            "type": "GlobalRotScaleTrans",
            "resize_lim": [
                0.9,
                1.1
            ],
            "rot_lim": [
                -0.78539816,
                0.78539816
            ],
            "trans_lim": 0.5,
            "is_train": true
        },
        {
            "type": "LoadBEVSegmentation",
            "dataset_root": "data/nuscenes/",
            "xbound": [
                -50.0,
                50.0,
                0.5
            ],
            "ybound": [
                -50.0,
                50.0,
                0.5
            ],
            "classes": [
                "drivable_area",
                "ped_crossing",
                "walkway",
                "stop_line",
                "carpark_area",
                "divider"
            ]
        },
        {
            "type": "RandomFlip3D"
        },
        {
            "type": "PointsRangeFilter",
            "point_cloud_range": [
                -54.0,
                -54.0,
                -5.0,
                54.0,
                54.0,
                3.0
            ]
        },
        {
            "type": "ObjectRangeFilter",
            "point_cloud_range": [
                -54.0,
                -54.0,
                -5.0,
                54.0,
                54.0,
                3.0
            ]
        },
        {
            "type": "ObjectNameFilter",
            "classes": [
                "car",
                "truck",
                "construction_vehicle",
                "bus",
                "trailer",
                "barrier",
                "motorcycle",
                "bicycle",
                "pedestrian",
                "traffic_cone"
            ]
        },
        {
            "type": "ImageNormalize",
            "mean": [
                0.485,
                0.456,
                0.406
            ],
            "std": [
                0.229,
                0.224,
                0.225
            ]
        },
        {
            "type": "GridMask",
            "use_h": true,
            "use_w": true,
            "max_epoch": 6,
            "rotate": 1,
            "offset": false,
            "ratio": 0.5,
            "mode": 1,
            "prob": 0.0,
            "fixed_prob": true
        },
        {
            "type": "PointShuffle"
        },
        {
            "type": "DefaultFormatBundle3D",
            "classes": [
                "car",
                "truck",
                "construction_vehicle",
                "bus",
                "trailer",
                "barrier",
                "motorcycle",
                "bicycle",
                "pedestrian",
                "traffic_cone"
            ]
        },
        {
            "type": "Collect3D",
            "keys": [
                "img",
                "points",
                "gt_bboxes_3d",
                "gt_labels_3d",
                "gt_masks_bev"
            ],
            "meta_keys": [
                "camera_intrinsics",
                "camera2ego",
                "lidar2ego",
                "lidar2camera",
                "camera2lidar",
                "lidar2image",
                "img_aug_matrix",
                "lidar_aug_matrix"
            ]
        }
    ],
    "test_pipeline": [
        {
            "type": "LoadMultiViewImageFromFiles",
            "to_float32": true
        },
        {
            "type": "LoadPointsFromFile",
            "coord_type": "LIDAR",
            "load_dim": 5,
            "use_dim": 5,
            "reduce_beams": 32,
            "load_augmented": null
        },
        {
            "type": "LoadPointsFromMultiSweeps",
            "sweeps_num": 9,
            "load_dim": 5,
            "use_dim": 5,
            "reduce_beams": 32,
            "pad_empty_sweeps": true,
            "remove_close": true,
            "load_augmented": null
        },
        {
            "type": "LoadAnnotations3D",
            "with_bbox_3d": true,
            "with_label_3d": true,
            "with_attr_label": false
        },
        {
            "type": "ImageAug3D",
            "final_dim": [
                256,
                704
            ],
            "resize_lim": [
                0.48,
                0.48
            ],
            "bot_pct_lim": [
                0.0,
                0.0
            ],
            "rot_lim": [
                0.0,
                0.0
            ],
            "rand_flip": false,
            "is_train": false
        },
        {
            "type": "GlobalRotScaleTrans",
            "resize_lim": [
                1.0,
                1.0
            ],
            "rot_lim": [
                0.0,
                0.0
            ],
            "trans_lim": 0.0,
            "is_train": false
        },
        {
            "type": "LoadBEVSegmentation",
            "dataset_root": "data/nuscenes/",
            "xbound": [
                -50.0,
                50.0,
                0.5
            ],
            "ybound": [
                -50.0,
                50.0,
                0.5
            ],
            "classes": [
                "drivable_area",
                "ped_crossing",
                "walkway",
                "stop_line",
                "carpark_area",
                "divider"
            ]
        },
        {
            "type": "PointsRangeFilter",
            "point_cloud_range": [
                -54.0,
                -54.0,
                -5.0,
                54.0,
                54.0,
                3.0
            ]
        },
        {
            "type": "ImageNormalize",
            "mean": [
                0.485,
                0.456,
                0.406
            ],
            "std": [
                0.229,
                0.224,
                0.225
            ]
        },
        {
            "type": "DefaultFormatBundle3D",
            "classes": [
                "car",
                "truck",
                "construction_vehicle",
                "bus",
                "trailer",
                "barrier",
                "motorcycle",
                "bicycle",
                "pedestrian",
                "traffic_cone"
            ]
        },
        {
            "type": "Collect3D",
            "keys": [
                "img",
                "points",
                "gt_bboxes_3d",
                "gt_labels_3d",
                "gt_masks_bev"
            ],
            "meta_keys": [
                "camera_intrinsics",
                "camera2ego",
                "lidar2ego",
                "lidar2camera",
                "camera2lidar",
                "lidar2image",
                "img_aug_matrix",
                "lidar_aug_matrix"
            ]
        }
    ],
    "data": {
        "samples_per_gpu": 4,
        "workers_per_gpu": 1,
        "train": {
            "type": "CBGSDataset",
            "dataset": {
                "type": "NuScenesDataset",
                "dataset_root": "data/nuscenes/",
                "ann_file": "data/nuscenes/nuscenes_infos_train.pkl",
                "pipeline": [
                    {
                        "type": "LoadMultiViewImageFromFiles",
                        "to_float32": true
                    },
                    {
                        "type": "LoadPointsFromFile",
                        "coord_type": "LIDAR",
                        "load_dim": 5,
                        "use_dim": 5,
                        "reduce_beams": 32,
                        "load_augmented": null
                    },
                    {
                        "type": "LoadPointsFromMultiSweeps",
                        "sweeps_num": 9,
                        "load_dim": 5,
                        "use_dim": 5,
                        "reduce_beams": 32,
                        "pad_empty_sweeps": true,
                        "remove_close": true,
                        "load_augmented": null
                    },
                    {
                        "type": "LoadAnnotations3D",
                        "with_bbox_3d": true,
                        "with_label_3d": true,
                        "with_attr_label": false
                    },
                    {
                        "type": "ObjectPaste",
                        "stop_epoch": -1,
                        "db_sampler": {
                            "dataset_root": "data/nuscenes/",
                            "info_path": "data/nuscenes/nuscenes_dbinfos_train.pkl",
                            "rate": 1.0,
                            "prepare": {
                                "filter_by_difficulty": [
                                    -1
                                ],
                                "filter_by_min_points": {
                                    "car": 5,
                                    "truck": 5,
                                    "bus": 5,
                                    "trailer": 5,
                                    "construction_vehicle": 5,
                                    "traffic_cone": 5,
                                    "barrier": 5,
                                    "motorcycle": 5,
                                    "bicycle": 5,
                                    "pedestrian": 5
                                }
                            },
                            "classes": [
                                "car",
                                "truck",
                                "construction_vehicle",
                                "bus",
                                "trailer",
                                "barrier",
                                "motorcycle",
                                "bicycle",
                                "pedestrian",
                                "traffic_cone"
                            ],
                            "sample_groups": {
                                "car": 2,
                                "truck": 3,
                                "construction_vehicle": 7,
                                "bus": 4,
                                "trailer": 6,
                                "barrier": 2,
                                "motorcycle": 6,
                                "bicycle": 6,
                                "pedestrian": 2,
                                "traffic_cone": 2
                            },
                            "points_loader": {
                                "type": "LoadPointsFromFile",
                                "coord_type": "LIDAR",
                                "load_dim": 5,
                                "use_dim": 5,
                                "reduce_beams": 32
                            }
                        }
                    },
                    {
                        "type": "ImageAug3D",
                        "final_dim": [
                            256,
                            704
                        ],
                        "resize_lim": [
                            0.38,
                            0.55
                        ],
                        "bot_pct_lim": [
                            0.0,
                            0.0
                        ],
                        "rot_lim": [
                            -5.4,
                            5.4
                        ],
                        "rand_flip": true,
                        "is_train": true
                    },
                    {
                        "type": "GlobalRotScaleTrans",
                        "resize_lim": [
                            0.9,
                            1.1
                        ],
                        "rot_lim": [
                            -0.78539816,
                            0.78539816
                        ],
                        "trans_lim": 0.5,
                        "is_train": true
                    },
                    {
                        "type": "LoadBEVSegmentation",
                        "dataset_root": "data/nuscenes/",
                        "xbound": [
                            -50.0,
                            50.0,
                            0.5
                        ],
                        "ybound": [
                            -50.0,
                            50.0,
                            0.5
                        ],
                        "classes": [
                            "drivable_area",
                            "ped_crossing",
                            "walkway",
                            "stop_line",
                            "carpark_area",
                            "divider"
                        ]
                    },
                    {
                        "type": "RandomFlip3D"
                    },
                    {
                        "type": "PointsRangeFilter",
                        "point_cloud_range": [
                            -54.0,
                            -54.0,
                            -5.0,
                            54.0,
                            54.0,
                            3.0
                        ]
                    },
                    {
                        "type": "ObjectRangeFilter",
                        "point_cloud_range": [
                            -54.0,
                            -54.0,
                            -5.0,
                            54.0,
                            54.0,
                            3.0
                        ]
                    },
                    {
                        "type": "ObjectNameFilter",
                        "classes": [
                            "car",
                            "truck",
                            "construction_vehicle",
                            "bus",
                            "trailer",
                            "barrier",
                            "motorcycle",
                            "bicycle",
                            "pedestrian",
                            "traffic_cone"
                        ]
                    },
                    {
                        "type": "ImageNormalize",
                        "mean": [
                            0.485,
                            0.456,
                            0.406
                        ],
                        "std": [
                            0.229,
                            0.224,
                            0.225
                        ]
                    },
                    {
                        "type": "GridMask",
                        "use_h": true,
                        "use_w": true,
                        "max_epoch": 6,
                        "rotate": 1,
                        "offset": false,
                        "ratio": 0.5,
                        "mode": 1,
                        "prob": 0.0,
                        "fixed_prob": true
                    },
                    {
                        "type": "PointShuffle"
                    },
                    {
                        "type": "DefaultFormatBundle3D",
                        "classes": [
                            "car",
                            "truck",
                            "construction_vehicle",
                            "bus",
                            "trailer",
                            "barrier",
                            "motorcycle",
                            "bicycle",
                            "pedestrian",
                            "traffic_cone"
                        ]
                    },
                    {
                        "type": "Collect3D",
                        "keys": [
                            "img",
                            "points",
                            "gt_bboxes_3d",
                            "gt_labels_3d",
                            "gt_masks_bev"
                        ],
                        "meta_keys": [
                            "camera_intrinsics",
                            "camera2ego",
                            "lidar2ego",
                            "lidar2camera",
                            "camera2lidar",
                            "lidar2image",
                            "img_aug_matrix",
                            "lidar_aug_matrix"
                        ]
                    }
                ],
                "object_classes": [
                    "car",
                    "truck",
                    "construction_vehicle",
                    "bus",
                    "trailer",
                    "barrier",
                    "motorcycle",
                    "bicycle",
                    "pedestrian",
                    "traffic_cone"
                ],
                "map_classes": [
                    "drivable_area",
                    "ped_crossing",
                    "walkway",
                    "stop_line",
                    "carpark_area",
                    "divider"
                ],
                "modality": {
                    "use_lidar": true,
                    "use_camera": true,
                    "use_radar": false,
                    "use_map": false,
                    "use_external": false
                },
                "test_mode": false,
                "use_valid_flag": true,
                "box_type_3d": "LiDAR"
            }
        },
        "val": {
            "type": "NuScenesDataset",
            "dataset_root": "data/nuscenes/",
            "ann_file": "data/nuscenes/nuscenes_infos_val.pkl",
            "pipeline": [
                {
                    "type": "LoadMultiViewImageFromFiles",
                    "to_float32": true
                },
                {
                    "type": "LoadPointsFromFile",
                    "coord_type": "LIDAR",
                    "load_dim": 5,
                    "use_dim": 5,
                    "reduce_beams": 32,
                    "load_augmented": null
                },
                {
                    "type": "LoadPointsFromMultiSweeps",
                    "sweeps_num": 9,
                    "load_dim": 5,
                    "use_dim": 5,
                    "reduce_beams": 32,
                    "pad_empty_sweeps": true,
                    "remove_close": true,
                    "load_augmented": null
                },
                {
                    "type": "LoadAnnotations3D",
                    "with_bbox_3d": true,
                    "with_label_3d": true,
                    "with_attr_label": false
                },
                {
                    "type": "ImageAug3D",
                    "final_dim": [
                        256,
                        704
                    ],
                    "resize_lim": [
                        0.48,
                        0.48
                    ],
                    "bot_pct_lim": [
                        0.0,
                        0.0
                    ],
                    "rot_lim": [
                        0.0,
                        0.0
                    ],
                    "rand_flip": false,
                    "is_train": false
                },
                {
                    "type": "GlobalRotScaleTrans",
                    "resize_lim": [
                        1.0,
                        1.0
                    ],
                    "rot_lim": [
                        0.0,
                        0.0
                    ],
                    "trans_lim": 0.0,
                    "is_train": false
                },
                {
                    "type": "LoadBEVSegmentation",
                    "dataset_root": "data/nuscenes/",
                    "xbound": [
                        -50.0,
                        50.0,
                        0.5
                    ],
                    "ybound": [
                        -50.0,
                        50.0,
                        0.5
                    ],
                    "classes": [
                        "drivable_area",
                        "ped_crossing",
                        "walkway",
                        "stop_line",
                        "carpark_area",
                        "divider"
                    ]
                },
                {
                    "type": "PointsRangeFilter",
                    "point_cloud_range": [
                        -54.0,
                        -54.0,
                        -5.0,
                        54.0,
                        54.0,
                        3.0
                    ]
                },
                {
                    "type": "ImageNormalize",
                    "mean": [
                        0.485,
                        0.456,
                        0.406
                    ],
                    "std": [
                        0.229,
                        0.224,
                        0.225
                    ]
                },
                {
                    "type": "DefaultFormatBundle3D",
                    "classes": [
                        "car",
                        "truck",
                        "construction_vehicle",
                        "bus",
                        "trailer",
                        "barrier",
                        "motorcycle",
                        "bicycle",
                        "pedestrian",
                        "traffic_cone"
                    ]
                },
                {
                    "type": "Collect3D",
                    "keys": [
                        "img",
                        "points",
                        "gt_bboxes_3d",
                        "gt_labels_3d",
                        "gt_masks_bev"
                    ],
                    "meta_keys": [
                        "camera_intrinsics",
                        "camera2ego",
                        "lidar2ego",
                        "lidar2camera",
                        "camera2lidar",
                        "lidar2image",
                        "img_aug_matrix",
                        "lidar_aug_matrix"
                    ]
                }
            ],
            "object_classes": [
                "car",
                "truck",
                "construction_vehicle",
                "bus",
                "trailer",
                "barrier",
                "motorcycle",
                "bicycle",
                "pedestrian",
                "traffic_cone"
            ],
            "map_classes": [
                "drivable_area",
                "ped_crossing",
                "walkway",
                "stop_line",
                "carpark_area",
                "divider"
            ],
            "modality": {
                "use_lidar": true,
                "use_camera": true,
                "use_radar": false,
                "use_map": false,
                "use_external": false
            },
            "test_mode": false,
            "box_type_3d": "LiDAR"
        },
        "test": {
            "type": "NuScenesDataset",
            "dataset_root": "data/nuscenes/",
            "ann_file": "data/nuscenes/nuscenes_infos_val.pkl",
            "pipeline": [
                {
                    "type": "LoadMultiViewImageFromFiles",
                    "to_float32": true
                },
                {
                    "type": "LoadPointsFromFile",
                    "coord_type": "LIDAR",
                    "load_dim": 5,
                    "use_dim": 5,
                    "reduce_beams": 32,
                    "load_augmented": null
                },
                {
                    "type": "LoadPointsFromMultiSweeps",
                    "sweeps_num": 9,
                    "load_dim": 5,
                    "use_dim": 5,
                    "reduce_beams": 32,
                    "pad_empty_sweeps": true,
                    "remove_close": true,
                    "load_augmented": null
                },
                {
                    "type": "LoadAnnotations3D",
                    "with_bbox_3d": true,
                    "with_label_3d": true,
                    "with_attr_label": false
                },
                {
                    "type": "ImageAug3D",
                    "final_dim": [
                        256,
                        704
                    ],
                    "resize_lim": [
                        0.48,
                        0.48
                    ],
                    "bot_pct_lim": [
                        0.0,
                        0.0
                    ],
                    "rot_lim": [
                        0.0,
                        0.0
                    ],
                    "rand_flip": false,
                    "is_train": false
                },
                {
                    "type": "GlobalRotScaleTrans",
                    "resize_lim": [
                        1.0,
                        1.0
                    ],
                    "rot_lim": [
                        0.0,
                        0.0
                    ],
                    "trans_lim": 0.0,
                    "is_train": false
                },
                {
                    "type": "LoadBEVSegmentation",
                    "dataset_root": "data/nuscenes/",
                    "xbound": [
                        -50.0,
                        50.0,
                        0.5
                    ],
                    "ybound": [
                        -50.0,
                        50.0,
                        0.5
                    ],
                    "classes": [
                        "drivable_area",
                        "ped_crossing",
                        "walkway",
                        "stop_line",
                        "carpark_area",
                        "divider"
                    ]
                },
                {
                    "type": "PointsRangeFilter",
                    "point_cloud_range": [
                        -54.0,
                        -54.0,
                        -5.0,
                        54.0,
                        54.0,
                        3.0
                    ]
                },
                {
                    "type": "ImageNormalize",
                    "mean": [
                        0.485,
                        0.456,
                        0.406
                    ],
                    "std": [
                        0.229,
                        0.224,
                        0.225
                    ]
                },
                {
                    "type": "DefaultFormatBundle3D",
                    "classes": [
                        "car",
                        "truck",
                        "construction_vehicle",
                        "bus",
                        "trailer",
                        "barrier",
                        "motorcycle",
                        "bicycle",
                        "pedestrian",
                        "traffic_cone"
                    ]
                },
                {
                    "type": "Collect3D",
                    "keys": [
                        "img",
                        "points",
                        "gt_bboxes_3d",
                        "gt_labels_3d",
                        "gt_masks_bev"
                    ],
                    "meta_keys": [
                        "camera_intrinsics",
                        "camera2ego",
                        "lidar2ego",
                        "lidar2camera",
                        "camera2lidar",
                        "lidar2image",
                        "img_aug_matrix",
                        "lidar_aug_matrix"
                    ]
                }
            ],
            "object_classes": [
                "car",
                "truck",
                "construction_vehicle",
                "bus",
                "trailer",
                "barrier",
                "motorcycle",
                "bicycle",
                "pedestrian",
                "traffic_cone"
            ],
            "map_classes": [
                "drivable_area",
                "ped_crossing",
                "walkway",
                "stop_line",
                "carpark_area",
                "divider"
            ],
            "modality": {
                "use_lidar": true,
                "use_camera": true,
                "use_radar": false,
                "use_map": false,
                "use_external": false
            },
            "test_mode": true,
            "box_type_3d": "LiDAR"
        }
    },
    "evaluation": {
        "interval": 1,
        "pipeline": [
            {
                "type": "LoadMultiViewImageFromFiles",
                "to_float32": true
            },
            {
                "type": "LoadPointsFromFile",
                "coord_type": "LIDAR",
                "load_dim": 5,
                "use_dim": 5,
                "reduce_beams": 32,
                "load_augmented": null
            },
            {
                "type": "LoadPointsFromMultiSweeps",
                "sweeps_num": 9,
                "load_dim": 5,
                "use_dim": 5,
                "reduce_beams": 32,
                "pad_empty_sweeps": true,
                "remove_close": true,
                "load_augmented": null
            },
            {
                "type": "LoadAnnotations3D",
                "with_bbox_3d": true,
                "with_label_3d": true,
                "with_attr_label": false
            },
            {
                "type": "ImageAug3D",
                "final_dim": [
                    256,
                    704
                ],
                "resize_lim": [
                    0.48,
                    0.48
                ],
                "bot_pct_lim": [
                    0.0,
                    0.0
                ],
                "rot_lim": [
                    0.0,
                    0.0
                ],
                "rand_flip": false,
                "is_train": false
            },
            {
                "type": "GlobalRotScaleTrans",
                "resize_lim": [
                    1.0,
                    1.0
                ],
                "rot_lim": [
                    0.0,
                    0.0
                ],
                "trans_lim": 0.0,
                "is_train": false
            },
            {
                "type": "LoadBEVSegmentation",
                "dataset_root": "data/nuscenes/",
                "xbound": [
                    -50.0,
                    50.0,
                    0.5
                ],
                "ybound": [
                    -50.0,
                    50.0,
                    0.5
                ],
                "classes": [
                    "drivable_area",
                    "ped_crossing",
                    "walkway",
                    "stop_line",
                    "carpark_area",
                    "divider"
                ]
            },
            {
                "type": "PointsRangeFilter",
                "point_cloud_range": [
                    -54.0,
                    -54.0,
                    -5.0,
                    54.0,
                    54.0,
                    3.0
                ]
            },
            {
                "type": "ImageNormalize",
                "mean": [
                    0.485,
                    0.456,
                    0.406
                ],
                "std": [
                    0.229,
                    0.224,
                    0.225
                ]
            },
            {
                "type": "DefaultFormatBundle3D",
                "classes": [
                    "car",
                    "truck",
                    "construction_vehicle",
                    "bus",
                    "trailer",
                    "barrier",
                    "motorcycle",
                    "bicycle",
                    "pedestrian",
                    "traffic_cone"
                ]
            },
            {
                "type": "Collect3D",
                "keys": [
                    "img",
                    "points",
                    "gt_bboxes_3d",
                    "gt_labels_3d",
                    "gt_masks_bev"
                ],
                "meta_keys": [
                    "camera_intrinsics",
                    "camera2ego",
                    "lidar2ego",
                    "lidar2camera",
                    "camera2lidar",
                    "lidar2image",
                    "img_aug_matrix",
                    "lidar_aug_matrix"
                ]
            }
        ]
    },
    "model": {
        "type": "BEVFusion",
        "encoders": {
            "camera": {
                "neck": {
                    "type": "GeneralizedLSSFPN",
                    "in_channels": [
                        192,
                        384,
                        768
                    ],
                    "out_channels": 256,
                    "start_level": 0,
                    "num_outs": 3,
                    "norm_cfg": {
                        "type": "BN2d",
                        "requires_grad": true
                    },
                    "act_cfg": {
                        "type": "ReLU",
                        "inplace": true
                    },
                    "upsample_cfg": {
                        "mode": "bilinear",
                        "align_corners": false
                    }
                },
                "vtransform": {
                    "type": "DepthLSSTransform",
                    "in_channels": 256,
                    "out_channels": 80,
                    "image_size": [
                        256,
                        704
                    ],
                    "feature_size": [
                        32,
                        88
                    ],
                    "xbound": [
                        -54.0,
                        54.0,
                        0.3
                    ],
                    "ybound": [
                        -54.0,
                        54.0,
                        0.3
                    ],
                    "zbound": [
                        -10.0,
                        10.0,
                        20.0
                    ],
                    "dbound": [
                        1.0,
                        60.0,
                        0.5
                    ],
                    "downsample": 2
                },
                "backbone": {
                    "type": "SwinTransformer",
                    "embed_dims": 96,
                    "depths": [
                        2,
                        2,
                        6,
                        2
                    ],
                    "num_heads": [
                        3,
                        6,
                        12,
                        24
                    ],
                    "window_size": 7,
                    "mlp_ratio": 4,
                    "qkv_bias": true,
                    "qk_scale": null,
                    "drop_rate": 0.0,
                    "attn_drop_rate": 0.0,
                    "drop_path_rate": 0.2,
                    "patch_norm": true,
                    "out_indices": [
                        1,
                        2,
                        3
                    ],
                    "with_cp": false,
                    "convert_weights": true,
                    "init_cfg": {
                        "type": "Pretrained",
                        "checkpoint": "https://github.com/SwinTransformer/storage/releases/download/v1.0.0/swin_tiny_patch4_window7_224.pth"
                    }
                }
            },
            "lidar": {
                "voxelize": {
                    "max_num_points": 10,
                    "point_cloud_range": [
                        -54.0,
                        -54.0,
                        -5.0,
                        54.0,
                        54.0,
                        3.0
                    ],
                    "voxel_size": [
                        0.075,
                        0.075,
                        0.2
                    ],
                    "max_voxels": [
                        120000,
                        160000
                    ]
                },
                "backbone": {
                    "type": "SparseEncoder",
                    "in_channels": 5,
                    "sparse_shape": [
                        1440,
                        1440,
                        41
                    ],
                    "output_channels": 128,
                    "order": [
                        "conv",
                        "norm",
                        "act"
                    ],
                    "encoder_channels": [
                        [
                            16,
                            16,
                            32
                        ],
                        [
                            32,
                            32,
                            64
                        ],
                        [
                            64,
                            64,
                            128
                        ],
                        [
                            128,
                            128
                        ]
                    ],
                    "encoder_paddings": [
                        [
                            0,
                            0,
                            1
                        ],
                        [
                            0,
                            0,
                            1
                        ],
                        [
                            0,
                            0,
                            [
                                1,
                                1,
                                0
                            ]
                        ],
                        [
                            0,
                            0
                        ]
                    ],
                    "block_type": "basicblock"
                }
            }
        },
        "fuser": {
            "type": "ConvFuser",
            "in_channels": [
                80,
                256
            ],
            "out_channels": 256
        },
        "heads": {
            "map": null,
            "object": {
                "type": "TransFusionHead",
                "num_proposals": 200,
                "auxiliary": true,
                "in_channels": 512,
                "hidden_channel": 128,
                "num_classes": 10,
                "num_decoder_layers": 1,
                "num_heads": 8,
                "nms_kernel_size": 3,
                "ffn_channel": 256,
                "dropout": 0.1,
                "bn_momentum": 0.1,
                "activation": "relu",
                "train_cfg": {
                    "dataset": "nuScenes",
                    "point_cloud_range": [
                        -54.0,
                        -54.0,
                        -5.0,
                        54.0,
                        54.0,
                        3.0
                    ],
                    "grid_size": [
                        1440,
                        1440,
                        41
                    ],
                    "voxel_size": [
                        0.075,
                        0.075,
                        0.2
                    ],
                    "out_size_factor": 8,
                    "gaussian_overlap": 0.1,
                    "min_radius": 2,
                    "pos_weight": -1,
                    "code_weights": [
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        0.2,
                        0.2
                    ],
                    "assigner": {
                        "type": "HungarianAssigner3D",
                        "iou_calculator": {
                            "type": "BboxOverlaps3D",
                            "coordinate": "lidar"
                        },
                        "cls_cost": {
                            "type": "FocalLossCost",
                            "gamma": 2.0,
                            "alpha": 0.25,
                            "weight": 0.15
                        },
                        "reg_cost": {
                            "type": "BBoxBEVL1Cost",
                            "weight": 0.25
                        },
                        "iou_cost": {
                            "type": "IoU3DCost",
                            "weight": 0.25
                        }
                    }
                },
                "test_cfg": {
                    "dataset": "nuScenes",
                    "grid_size": [
                        1440,
                        1440,
                        41
                    ],
                    "out_size_factor": 8,
                    "voxel_size": [
                        0.075,
                        0.075
                    ],
                    "pc_range": [
                        -54.0,
                        -54.0
                    ],
                    "nms_type": null
                },
                "common_heads": {
                    "center": [
                        2,
                        2
                    ],
                    "height": [
                        1,
                        2
                    ],
                    "dim": [
                        3,
                        2
                    ],
                    "rot": [
                        2,
                        2
                    ],
                    "vel": [
                        2,
                        2
                    ]
                },
                "bbox_coder": {
                    "type": "TransFusionBBoxCoder",
                    "pc_range": [
                        -54.0,
                        -54.0
                    ],
                    "post_center_range": [
                        -61.2,
                        -61.2,
                        -10.0,
                        61.2,
                        61.2,
                        10.0
                    ],
                    "score_threshold": 0.0,
                    "out_size_factor": 8,
                    "voxel_size": [
                        0.075,
                        0.075
                    ],
                    "code_size": 10
                },
                "loss_cls": {
                    "type": "FocalLoss",
                    "use_sigmoid": true,
                    "gamma": 2.0,
                    "alpha": 0.25,
                    "reduction": "mean",
                    "loss_weight": 1.0
                },
                "loss_heatmap": {
                    "type": "GaussianFocalLoss",
                    "reduction": "mean",
                    "loss_weight": 1.0
                },
                "loss_bbox": {
                    "type": "L1Loss",
                    "reduction": "mean",
                    "loss_weight": 0.25
                }
            }
        },
        "decoder": {
            "backbone": {
                "type": "SECOND",
                "in_channels": 256,
                "out_channels": [
                    128,
                    256
                ],
                "layer_nums": [
                    5,
                    5
                ],
                "layer_strides": [
                    1,
                    2
                ],
                "norm_cfg": {
                    "type": "BN",
                    "eps": 0.001,
                    "momentum": 0.01
                },
                "conv_cfg": {
                    "type": "Conv2d",
                    "bias": false
                }
            },
            "neck": {
                "type": "SECONDFPN",
                "in_channels": [
                    128,
                    256
                ],
                "out_channels": [
                    256,
                    256
                ],
                "upsample_strides": [
                    1,
                    2
                ],
                "norm_cfg": {
                    "type": "BN",
                    "eps": 0.001,
                    "momentum": 0.01
                },
                "upsample_cfg": {
                    "type": "deconv",
                    "bias": false
                },
                "use_conv_for_no_stride": true
            }
        }
    },
    "optimizer": {
        "type": "AdamW",
        "lr": 0.0002,
        "weight_decay": 0.01
    },
    "optimizer_config": {
        "grad_clip": {
            "max_norm": 35,
            "norm_type": 2
        }
    },
    "lr_config": {
        "policy": "CosineAnnealing",
        "warmup": "linear",
        "warmup_iters": 500,
        "warmup_ratio": 0.33333333,
        "min_lr_ratio": 0.001
    },
    "momentum_config": {
        "policy": "cyclic"
    }
}